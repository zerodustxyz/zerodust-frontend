# ZeroDust - Full Documentation

> Sweep native gas tokens to exactly zero across 25+ EVM chains.

ZeroDust sweeps 100% of native gas tokens (ETH, BNB, POL, etc.) from any supported EVM chain, leaving exactly zero balance. Funds are sent to any address on the same or a different chain via a relayer that handles gas fees.

## How it works

1. Sign an EIP-7702 authorization (delegates your EOA temporarily)
2. Sign an EIP-712 sweep intent (specifies destination and fee limits)
3. ZeroDust's relayer executes the sweep atomically
4. Balance goes to exactly zero, funds arrive at your destination
5. Delegation is automatically revoked after the sweep

## Supported chains

Ethereum, Arbitrum, Base, Optimism, Polygon, BSC, Gnosis, Scroll, Linea, Mode, Mantle, Celo, Blast, Unichain, World Chain, Berachain, Ink, Plasma, BOB, Story, Fraxtal, Superseed, Apechain, Sei, Sonic, Soneium, and Zora.

## Fee structure

- Free tier: No service fee for sweeps under $1
- Standard: 1% service fee (min $0.05, max $0.50)
- Gas: Paid by relayer, reimbursed from swept amount
- Users always receive the quoted amount or more

## SDK

### Installation

```bash
npm install @zerodust/sdk viem
```

### ZeroDust client

For wallet integrations and applications where the user signs transactions in a browser wallet:

```typescript
import { ZeroDust } from '@zerodust/sdk';

const zerodust = new ZeroDust({ environment: 'mainnet' });
```

#### Configuration options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| environment | 'mainnet' or 'testnet' | 'testnet' | API environment |
| apiKey | string | - | Optional partner API key |
| baseUrl | string | - | Custom API URL (overrides environment) |
| timeout | number | 30000 | Request timeout in ms |
| retries | number | 3 | Number of retries for failed requests |

#### Methods

**getChains()** - Returns all supported chains with their configuration.

**getChain(chainId)** - Returns a single chain by ID.

**getBalances(address)** - Returns balances across all chains for an address. Each chain entry includes chainId, name, nativeToken, balance, balanceFormatted, canSweep, and minBalance.

**getBalance(chainId, address)** - Returns balance for a specific chain.

**getQuote({ fromChainId, toChainId, userAddress, destination })** - Returns a quote including quoteId, estimatedReceive, fees, and deadline.

**createAuthorization(quoteId)** - Returns EIP-712 typed data for signing and contractAddress for EIP-7702 authorization.

**submitSweep({ quoteId, signature, eip7702Authorization, revokeAuthorization? })** - Submits the signed sweep. Returns sweepId and status.

**getSweepStatus(sweepId)** - Returns current sweep status including txHash when completed.

**getSweeps(address, { limit?, offset?, status? })** - Returns list of sweeps for an address with pagination.

**waitForSweep(sweepId, { onStatusChange?, timeout?, pollInterval? })** - Polls until sweep reaches a terminal state.

### ZeroDustAgent class

For AI agents and automated systems that hold their own private key:

```typescript
import { createAgentFromPrivateKey } from '@zerodust/sdk';

const agent = createAgentFromPrivateKey('0xPrivateKey...', {
  environment: 'mainnet',
});
```

#### Methods

**getBalances()** - Returns balances for the agent's address.

**sweep({ fromChainId, toChainId, destination })** - Performs the full sweep flow (quote, sign, submit) in one call.

**getSweepStatus(sweepId)** - Returns current sweep status.

**getSweeps({ limit?, offset?, status? })** - Returns list of sweeps for the agent's address.

### Full sweep flow example

```typescript
import { ZeroDust } from '@zerodust/sdk';
import { createWalletClient, http } from 'viem';
import { privateKeyToAccount } from 'viem/accounts';
import { arbitrum } from 'viem/chains';

const zerodust = new ZeroDust({ environment: 'mainnet' });

// 1. Check balances
const balances = await zerodust.getBalances('0xYourAddress...');

// 2. Get a quote
const quote = await zerodust.getQuote({
  fromChainId: 42161,
  toChainId: 8453,
  userAddress: '0xYourAddress...',
  destination: '0xDestination...',
});

// 3. Create authorization (get typed data)
const { typedData, contractAddress } = await zerodust.createAuthorization(quote.quoteId);

// 4. Sign EIP-712 sweep intent
const account = privateKeyToAccount('0xPrivateKey...');
const walletClient = createWalletClient({ account, chain: arbitrum, transport: http() });

const signature = await walletClient.signTypedData({
  domain: typedData.domain,
  types: typedData.types,
  primaryType: typedData.primaryType,
  message: typedData.message,
});

// 5. Sign EIP-7702 authorization
const authorization = await walletClient.signAuthorization({ contractAddress });

// 6. Submit
const sweep = await zerodust.submitSweep({
  quoteId: quote.quoteId,
  signature,
  eip7702Authorization: {
    chainId: authorization.chainId,
    contractAddress,
    nonce: authorization.nonce,
    yParity: authorization.yParity,
    r: authorization.r,
    s: authorization.s,
  },
});

// 7. Wait for completion
const result = await zerodust.waitForSweep(sweep.sweepId);
```

### Error handling

The SDK throws typed errors with error codes:

| Code | Description |
|------|-------------|
| BALANCE_TOO_LOW | Balance insufficient for sweep |
| QUOTE_EXPIRED | Quote has expired |
| INVALID_ADDRESS | Invalid Ethereum address |
| CHAIN_NOT_SUPPORTED | Chain ID not supported |
| INVALID_SIGNATURE | Invalid EIP-712 signature |
| QUOTE_NOT_FOUND | Quote ID not found |
| SERVICE_UNAVAILABLE | Service temporarily down |

## AI Integrations

### MCP Server

The @zerodust/mcp-server package provides a Model Context Protocol server for Claude Desktop, Claude Code, and other MCP-compatible clients.

```bash
npx @zerodust/mcp-server
```

Add to Claude Desktop config (~/Library/Application Support/Claude/claude_desktop_config.json):

```json
{
  "mcpServers": {
    "zerodust": {
      "command": "npx",
      "args": ["@zerodust/mcp-server"]
    }
  }
}
```

Environment variables:
- ZERODUST_API_URL: Custom API URL (default: https://api.zerodust.xyz)
- ZERODUST_API_KEY: API key for higher rate limits

### LangChain Tools

```bash
npm install @zerodust/langchain @langchain/core zod
```

```typescript
import { createZeroDustTools } from '@zerodust/langchain';
import { ChatOpenAI } from '@langchain/openai';
import { AgentExecutor, createToolCallingAgent } from 'langchain/agents';
import { ChatPromptTemplate } from '@langchain/core/prompts';

const tools = createZeroDustTools({ environment: 'mainnet' });
const llm = new ChatOpenAI({ model: 'gpt-4o' });
const prompt = ChatPromptTemplate.fromMessages([
  ['system', 'You are a helpful blockchain assistant.'],
  ['human', '{input}'],
  ['placeholder', '{agent_scratchpad}'],
]);

const agent = createToolCallingAgent({ llm, tools, prompt });
const executor = new AgentExecutor({ agent, tools });
const result = await executor.invoke({ input: 'Check balances for 0x...' });
```

### Vercel AI SDK Tools

```bash
npm install @zerodust/ai-sdk ai zod
```

```typescript
import { createZeroDustTools } from '@zerodust/ai-sdk';
import { generateText } from 'ai';
import { openai } from '@ai-sdk/openai';

const tools = createZeroDustTools({ environment: 'mainnet' });

const { text } = await generateText({
  model: openai('gpt-4o'),
  tools,
  prompt: 'Check balances for 0x...',
});
```

### Available tools (all integrations)

All AI integrations expose the same 6 tools:

- **zerodust_info** - Returns information about ZeroDust including supported chains
- **zerodust_get_chains** - List all supported chains with details
- **zerodust_get_balances** - Get balances across all chains for an address (requires: address)
- **zerodust_get_quote** - Get a sweep quote (requires: fromChainId, toChainId, userAddress, destination)
- **zerodust_get_sweep_status** - Check the status of a sweep (requires: sweepId)
- **zerodust_list_sweeps** - List sweep history for an address (requires: address; optional: limit, offset, status)

## REST API

Base URL: https://api.zerodust.xyz

### Authentication

Optional API key via header: X-API-Key: your-api-key

### GET /chains

Returns list of supported chains.

Response: { chains: [{ chainId, name, nativeToken, nativeTokenDecimals, minBalance, contractAddress, explorerUrl, enabled }] }

### GET /balances/:address

Returns balances across all chains.

Parameters: address (path) - Ethereum address

Response: { address, chains: [{ chainId, name, nativeToken, balance, balanceFormatted, canSweep, minBalance }] }

### GET /quote

Get a sweep quote.

Query parameters: fromChainId (number), toChainId (number), userAddress (string), destination (string)

Response: { quoteId, version, userBalance, estimatedReceive, mode, fees: { overheadGasUnits, protocolFeeGasUnits, extraFeeWei, reimbGasPriceCapWei, maxTotalFeeWei, revokeGasUnits }, autoRevoke, intent: { mode, destination, destinationChainId, callTarget, routeHash, minReceive }, deadline, nonce, authNonce, validForSeconds }

### POST /authorization

Create EIP-712 typed data for signing.

Body: { quoteId }

Response: { sweepType, typedData: { types, primaryType, domain, message }, contractAddress, version }

### POST /sweep

Submit a signed sweep.

Body: { quoteId, signature, eip7702Authorization: { chainId, contractAddress, nonce, yParity, r, s }, revokeAuthorization? }

Response: { sweepId, status, sweepType, isExisting, version }

### GET /sweep/:sweepId

Get sweep status.

Response: { sweepId, status, sweepType, mode, txHash, destination, fromChainId, toChainId, amountSent, bridgeTrackingUrl, version, createdAt, updatedAt, revokeStatus }

### GET /sweeps/:address

List sweeps for an address.

Query parameters: limit (number, default 20, max 100), offset (number), status (string)

Response: { sweeps: [{ sweepId, status, sweepType, mode, fromChainId, toChainId, amountSent, txHash, version, createdAt }], total }

### Error responses

Format: { error: "message", code: "ERROR_CODE" }

Codes: BALANCE_TOO_LOW, QUOTE_EXPIRED, INVALID_ADDRESS, CHAIN_NOT_SUPPORTED, INVALID_SIGNATURE, QUOTE_NOT_FOUND, SERVICE_UNAVAILABLE
